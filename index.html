<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>CEAG | Plantas potabilizadoras </title>
  <meta name="keywords" content="" />
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- VIDEOJS CSS & MAQUETA -->
  <link href="three/css/video-js.css" rel="stylesheet" />
  <link href="three/css/videoContainer.css" rel="stylesheet" />
  <script src="three/js/mobile-detect.js"></script>
  <script src="three/js/imageMapResizer.min.js"></script>
  <link href="three/css/estilo.css" rel="stylesheet" />



  <!-- Mobile view -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Favicon -->
  <link rel="shortcut icon" href="html/images/icono.ico">
  <link rel="stylesheet" type="text/css" href="html/js/bootstrap/bootstrap.min.css">



  <!-- Template's stylesheets -->
  <link rel="stylesheet" href="html/js/megamenu/stylesheets/screen.css">
  <link rel="stylesheet" href="html/css/theme-default.css" type="text/css">
  <link rel="stylesheet" href="html/js/loaders/stylesheets/screen.css">
  <link rel="stylesheet" href="html/css/corporate.css" type="text/css">
  <link rel="stylesheet" href="html/fonts/font-awesome/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" type="text/css" href="html/fonts/Simple-Line-Icons-Webfont/simple-line-icons.css"
    media="screen" />
  <link rel="stylesheet" href="html/fonts/et-line-font/et-line-font.css">
  <link rel="stylesheet" type="text/css" href="html/js/revolution-slider/css/settings.css">
  <link rel="stylesheet" type="text/css" href="html/js/revolution-slider/css/layers.css">
  <link rel="stylesheet" type="text/css" href="html/js/revolution-slider/css/navigation.css">

  <link rel="stylesheet" type="text/css" href="html/js/cubeportfolio/cubeportfolio.min.css">


  <link rel="stylesheet" href="html/fonts/pe-icon-7-stroke/css/pe-icon-7-stroke.css">
  <link rel="stylesheet" href="html/js/ytplayer/ytplayer.css" />
  <link href="html/js/accordion/css/smk-accordion.css" rel="stylesheet">
  <link rel="stylesheet" href="html/fonts/pe-icon-7-stroke/css/pe-icon-7-stroke.css">

  <script src="https://kit.fontawesome.com/ed25e436db.js" crossorigin="anonymous"></script>


  <!-- Template's stylesheets END -->

  <!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

  <!-- Style Customizer's stylesheets -->
  <link rel="stylesheet" type="text/css" href="html/js/style-customizer/css/spectrum.css">
  <link rel="stylesheet" type="text/css" href="html/js/style-customizer/css/style-customizer.css">
  <link rel="stylesheet/less" type="text/css" href="html/less/skin.less">
  <!-- Style Customizer's stylesheets END -->

  <!-- Skin stylesheet -->

</head>

<body>

  <div class="header-section dark ">
    <div class="container">
      <div>
        <div class="row">



          <div id="menuTop" class="col-sm-8  hidden-xs hidden-md hidden-sm">
            <ul class="nav navbar-nav">

              <li> <a href="tel:014737351800">

                  <div class="proxima-nova diez subrayar"><i class="fas fa-phone-alt padding-right"></i>01 (473) 7351800
                  </div>
                </a>
              </li>

              <li> <a href="http://agua.guanajuato.gob.mx/contactanos.php">

                  <div class="proxima-nova diez subrayar"><i class="far fa-envelope padding-right"></i>Contáctanos</div>
                </a>
              </li>

              <li> <a href="http://agua.guanajuato.gob.mx/index.php#">

                  <div class="proxima-nova diez subrayar"> <i class="fas fa-wheelchair padding-right"></i>Accesibilidad
                  </div>
                </a>
              </li>

              <li> <a href="https://sistemassp.guanajuato.gob.mx/cgob/index.php/chat?locale=es">

                  <div class="proxima-nova diez subrayar"><i class="fas fa-comments padding-right"></i>Chat en línea
                  </div>
                </a>
              </li>


            </ul>

          </div>


          <div class="col-sm-4 ">
            <div class="main-nav">
              <ul class="nav navbar-nav top-nav iconos">

                <li class="hover2"> <a href="tel:014737351800"> <i class="fas fa-phone-alt"></i></a></li>
                <li class="hover2"> <a href="https://www.facebook.com/AguaGto"> <i class="fab fa-facebook-f"></i> </a></li>
                <li class="hover2"> <a href="https://www.twitter.com/Agua_Gto"> <i class="fab fa-twitter"></i></a></li>
                <li class="hover2"> <a href="https://www.instagram.com/agua_gto"> <i class="fab fa-instagram"></i></a></li>
                <li class="hover2"> <a href="https://www.youtube.com/user/CuidemosAguanajuato"> <i class="fab fa-youtube"></i></a></li>


              </ul>

            </div>


          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
  </div>
  <!--end menu-->

  <div class="header-section white dark-dropdowns style1 links-dark margin-cero">
    <div class="container">
      <div class="mod-menu">
        <div class="row">
          <div class="col-sm-3"> <a href="http://agua.guanajuato.gob.mx/" title="" class="logo style-2 mar-4">
              <img src="three/img/logo-D3.png">
            </a> </div>
          <div class="col-sm-9">
            <div class="main-nav">
              <ul class="nav navbar-nav top-nav">


                <li class="visible-xs menu-icon"> <a href="javascript:void(0)" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target="#menu" aria-expanded="false"> <i aria-hidden="true"
                      class="fa fa-bars"></i> </a> </li>
              </ul>
              <div id="menu" class="collapse">
                <ul class="nav navbar-nav">
                  <li class="hover"> <a href="http://agua.guanajuato.gob.mx/index.php"><i class="fas fa-home"></i></a>
                  </li>
                  <li class="proxima-nova doce hover"> <a href="#funcionamiento">Funcionamiento</a> </li>
                  <li class="proxima-nova doce hover"> <a href="#mantenimiento">Mantenimiento</a> </li>


                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--end menu-->

  </div>



  <!-- MAQUETA -->
  <script src="three/js/video.js"></script>
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="three/js/jquery-3.2.1.slim.min.js"></script>
  <script src="three/js/popper.min.js"></script>

  <!-- THREE.JS  -->
  <script type="module">

    import * as THREE from './build/three.module.js';
    import { OrbitControls } from './three/jsm/controls/OrbitControls.js';
    import { GLTFLoader } from './three/jsm/loaders/GLTFLoader.js';
    import { ShadowMapViewer } from './three/jsm/utils/ShadowMapViewer.js';
    import { CSS2DRenderer, CSS2DObject } from './three/jsm/renderers/CSS2DRenderer.js';
    import { GUI } from './three/jsm/libs/dat.gui.module.js';
    import { EffectComposer } from './three/jsm/postprocessing/EffectComposer.js';
    import { RenderPass } from './three/jsm/postprocessing/RenderPass.js';
    import { ShaderPass } from './three/jsm/postprocessing/ShaderPass.js';
    import { OutlinePass } from './three/jsm/postprocessing/OutlinePass.js';
    import { FXAAShader } from './three/jsm/shaders/FXAAShader.js';

    import { CopyShader } from './three/jsm/shaders/CopyShader.js';

    import { RGBELoader } from './three/jsm/loaders/RGBELoader.js';

    var selectedObjects = [];



    var params = {

      clearPass: true,
      clearColor: 'white',
      clearAlpha: 1.0,

      texturePass: true,
      texturePassOpacity: 1.0,

      cubeTexturePass: true,
      cubeTexturePassOpacity: 1.0,

      renderPass: true
    };

    const loadingManager = new THREE.LoadingManager(() => {

      const loadingScreen = document.getElementById('loading-screen');
      loadingScreen.classList.add('fade-out');

      //optional: remove loader from DOM via event listeneer
      loadingScreen.addEventListener('transitionend', onTransitionEnd);

    });


    var detector = new MobileDetect(window.navigator.userAgent)
    console.log("Mobile: " + detector.mobile());
    console.log("Phone: " + detector.phone());
    console.log("Tablet: " + detector.tablet());
    console.log("OS: " + detector.os());
    console.log("userAgent: " + detector.userAgent());

    if (detector.mobile() != null) {
      console.log("ESTAS EN MOBILE");
      validaOrientacion();

      $('#txtInfo').addClass('invisible');



      $('#js-filters-mosaic-flat').addClass('invisible');

      $('#labels').addClass('invisible');







      $('#canvas1').addClass('invisible');
      $('#labels').remove();
      $('#canvas1').remove();




      const loadingScreen = document.getElementById('loading-screen');
      loadingScreen.classList.add('fade-out');


    } else {
      console.log("ESTAS EN DESKTOP");
      $('#plantaMobile').addClass('invisible');








      loadModels();
    }

    $('#exampleModalCenter').on('hidden.bs.modal', function (e) {
      console.log("modal cerrado");

      const myPlayer = videojs("my-video");
      myPlayer.pause();

      //zoom out
      //camera.lookAt(0, 0, 0);
      //camera.getWorldDirection(dir);
      //camera.position.addScaledVector(dir, -speed);
    })

    $('#modalMobile').on('hidden.bs.modal', function (e) {

      const myPlayer = videojs("my-video2");
      myPlayer.pause();
    })






    window.addEventListener("orientationchange", function () {
      console.log("the orientation of the device is now " + screen.orientation.angle);
      validaOrientacion();
    });

    $("#iniciar").click(function () {
      //cierraBienvenida();
      inicialPlay();
    });
    $("#abrir").click(function () {
      cierraBienvenida();
      //inicialPlay();
    });

    $('#map1').click(function () {
      abreModalMobile(1);
    });
    $('#map1a').click(function () {
      abreModalMobile(1);
    });

    $('#map2').click(function () {
      abreModalMobile(2);
    });
    $('#map2a').click(function () {
      abreModalMobile(2);
    });
    $('#map3').click(function () {
      abreModalMobile(3);
    });
    $('#map3a').click(function () {
      abreModalMobile(3);
    });
    $('#map4').click(function () {
      abreModalMobile(4);
    });
    $('#map4a').click(function () {
      abreModalMobile(4);
    });
    $('#map5').click(function () {
      abreModalMobile(5);
    });
    $('#map5a').click(function () {
      abreModalMobile(5);
    });
    $('#map6').click(function () {
      abreModalMobile(6);
    });
    $('#map6a').click(function () {
      abreModalMobile(6);
    });
    $('#map7').click(function () {
      abreModalMobile(7);
    });
    $('#map7a').click(function () {
      abreModalMobile(7);
    });
    $('#map8').click(function () {
      abreModalMobile(8);
    });
    $('#map8a').click(function () {
      abreModalMobile(8);
    });
    $('#map9').click(function () {
      abreModalMobile(9);
    });
    $('#map9a').click(function () {
      abreModalMobile(9);
    });
    $('#map10').click(function () {
      abreModalMobile(10);
    });
    $('#map10a').click(function () {
      abreModalMobile(10);
    });
    $('#map11').click(function () {
      abreModalMobile(11);
    });
    $('#map11a').click(function () {
      abreModalMobile(11);
    });
    $('#map12').click(function () {
      abreModalMobile(12);
    });
    $('#map12a').click(function () {
      abreModalMobile(12);
    });

    function abreModalMobile(valor) {

      console.log('MOBILE ' + valor);
      var titulo;

      switch (valor) {

        case 1:
          titulo = "1. Cloración";
          break;

        case "1":
          titulo = "1. Cloración";
          break;

        case 2:
          titulo = "2. Recipiente de agua cruda";
          break;
        case "2":
          titulo = "2. Recipiente de agua cruda";
          break;

        case 3:
          titulo = "3. Turbidex";
          break;

        case "3":
          titulo = "3. Turbidex";
          break;

        case 4:
          titulo = "4. Carbón activado";
          break;
        case "4":
          titulo = "4. Carbón activado";
          break;

        case 5:
          titulo = "5. Suavizador";
          break;
        case "5":
          titulo = "5. Suavizador";
          break;

        case 6:
          titulo = "6. Muestreo";
          break;
        case "6":
          titulo = "6. Muestreo";
          break;

        case 7:
          titulo = "7. Ósmosis inversa";
          break;

        case "7":
          titulo = "7. Ósmosis inversa";
          break;


        case 8:
          titulo = "8. Cisterna de agua potabilizadora";
          break;

        case "8":
          titulo = "8. Cisterna de agua potabilizadora";
          break;

        case 9:
          titulo = "9. Lámpara de luz ultravioleta";
          break;

        case "9":
          titulo = "9. Lámpara de luz ultravioleta";
          break;

        case 10:
          titulo = "10. Generadora de ozono";
          break;
        case "10":
          titulo = "10. Generadora de ozono";
          break;

        case 11:
          titulo = "11. Lavado de garrafones";
          break;

        case "11":
          titulo = "11. Lavado de garrafones";
          break;

        case 12:
          titulo = "12. Llenado de garrafones";
          break;

        case "12":
          titulo = "12. Llenado de garrafones";
          break;
      }

      if (valor != 0) {
        $("#modalMobile").modal();

        $('#modalMobileTitle').text(titulo);

        const video = videojs("my-video2");
        video.src("html/video/" + valor + ".mp4");

        $('#imgZoom').attr("src", "three/img/capturas/" + valor + ".jpg");

        video.src({
          type: 'video/mp4',
          src: "three/video/" + valor + ".mp4"
        });

        const myPlayer = videojs("my-video2");
        myPlayer.play();
      }



    }








    function validaOrientacion() {

      if (screen.orientation.angle == 0) {
        console.log("portrait es visible");

        $('#verticalMobile').addClass('visible');
        $('#verticalMobile').removeClass('invisible');

      }

      if (screen.orientation.angle == 90) {
        console.log("portrait es invisible");

        $('#verticalMobile').addClass('invisible');
        $('#verticalMobile').removeClass('visible');

      }

    }

    function cierraBienvenida() {

      $('#welcome').addClass('invisible');
      $('#welcome').removeClass('visible');


    }


    var gui;
    var labelRenderer;
    var SHADOW_MAP_WIDTH = 2048, SHADOW_MAP_HEIGHT = 1024;

    var SCREEN_WIDTH = window.innerWidth;
    var SCREEN_HEIGHT = window.innerHeight;
    var aspect = SCREEN_WIDTH / SCREEN_HEIGHT;





    var FLOOR = - 250;
    var lightShadowMapViewer;
    var light;

    const dir = new THREE.Vector3();
    const speed = 25.0;

    var mouse = new THREE.Vector2(), INTERSECTED;

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0xffffff);

    const sceneCube = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(25, aspect * 2, 0.1, 100);
    camera.position.set(0, 8, 16);

    const raycaster = new THREE.Raycaster();

    var camPosX = 0;
    var camPosY = 0;
    var camPosZ = 0;

    const camVector = new THREE.Vector3();

    // Load a Renderer
    const renderer = new THREE.WebGLRenderer({ antialias: true });

    container = document.getElementById('canvas1');
    container.appendChild(renderer.domElement);


    renderer.autoClear = false;

    //renderer.setClearColor(0x000000, 0.0);
    renderer.setPixelRatio(window.devicePixelRatio);
    //renderer.setSize(window.innerWidth, window.innerHeight / 2);

    renderer.setSize(container.offsetWidth, container.offsetHeight);
    //document.body.appendChild(renderer.domElement);



    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFShadowMap;

    var rect = renderer.domElement.getBoundingClientRect();

    document.getElementById('canvas1').appendChild(renderer.domElement);

    var composer, composer2, fxaaPass, outlinePass, container;



    composer = new EffectComposer(renderer);
    composer2 = new EffectComposer(renderer);
    //composer3 = new EffectComposer(renderer);


    var renderPass = new RenderPass(scene, camera);
    //composer.addPass(renderPass);




    fxaaPass = new ShaderPass(FXAAShader);

    var pixelRatio = renderer.getPixelRatio();

    fxaaPass.material.uniforms['resolution'].value.x = 1 / (container.offsetWidth * pixelRatio);
    fxaaPass.material.uniforms['resolution'].value.y = 1 / (container.offsetHeight * pixelRatio);
    composer2.addPass(renderPass);
    //composer3.addPass(renderPass);
    //composer2.addPass(fxaaPass);

    outlinePass = new OutlinePass(new THREE.Vector2(aspect), scene, camera);
    //composer.addPass(outlinePass);
    outlinePass.edgeStrength = 5;
    outlinePass.edgeThickness = 2;

    //composer3.addPass(outlinePass);




    // Load Light
    const ambientLight = new THREE.AmbientLight(0x404040);
    //scene.add(ambientLight);

    var luz;

    const lights = [];
    lights[0] = new THREE.DirectionalLight(0x4fd6ff, 0);
    lights[0].position.set(1, 2, 0);
    lights[1] = new THREE.PointLight(0xffffff, .3);
    lights[1].position.set(1, 5, 0);
    lights[2] = new THREE.DirectionalLight(0xffffff, 0);
    lights[2].position.set(-0.75, -1, 0.5);

    lights[1].castShadow = true;
    lights[1].receiveShadow = true;
    lights[1].shadow.camera.near = 0.1;       // default
    lights[1].shadow.camera.far = 350      // default
    lights[1].shadow.mapSize.width = 512;  // default
    lights[1].shadow.mapSize.height = 512; // default



    luz = new THREE.SpotLight(0xaff6fe, 2);
    luz.position.set(0, -4.5, 0);
    scene.add(luz);

    //luz.castShadow = true;

    scene.add(lights[1]);

    const pmremGenerator = new THREE.PMREMGenerator(renderer);
    pmremGenerator.compileEquirectangularShader();
    const loader = new GLTFLoader();

    var geometry = new THREE.BoxGeometry();
    var material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    var cube = new THREE.Mesh(geometry, material);

    init();

    function init() {
      imageMapResize();
      labelRenderer = new CSS2DRenderer();
      labelRenderer.setSize(window.innerWidth, window.innerHeight / 2);
      //labelRenderer.domElement.style.position = 'absolute';
      // labelRenderer.domElement.style.top = 0;
      document.getElementById('labels').appendChild(labelRenderer.domElement);

      const controls = new OrbitControls(camera, renderer.domElement);
      controls.target.set(0, 0, 1);
      //  horizontally angle control
      controls.minAzimuthAngle = -Math.PI / 14;
      controls.maxAzimuthAngle = Math.PI / 14;

      // vertical angle control
      controls.minPolarAngle = Math.PI / 5;
      controls.maxPolarAngle = Math.PI / 2.3;

      // Enable Damping
      controls.enableDamping = false;
      controls.dampingFactor = 0.9;

      // HorizontalPanning ( 0 ScreenSpacePanning is the default)
      //controls.panningMode = 0;
      controls.enablePan = false;
      //controls.screenSpacePanning = false;

      // How far you can dolly in and out ( PerspectiveCamera only )
      controls.minDistance = 15;
      controls.maxDistance = 25;


      controls.update();


      light = new THREE.SpotLight(0xffffff, 1, 0, Math.PI / 5, 0.3);
      light.position.set(0, 100, 0);
      light.target.position.set(0, 0, 0);

      light.castShadow = true;
      light.shadow.camera.near = 1200;
      light.shadow.camera.far = 2500;
      light.shadow.bias = 0.0001;

      light.shadow.mapSize.width = SHADOW_MAP_WIDTH;
      light.shadow.mapSize.height = SHADOW_MAP_HEIGHT;

      scene.add(light);

      new RGBELoader()
        .setDataType(THREE.UnsignedByteType)
        .setPath('three/hdr/')
        .load('studio2.hdr', function (texture) {

          var envMap = pmremGenerator.fromEquirectangular(texture).texture;

          //scene.background = envMap;
          scene.environment = envMap;


          texture.dispose();
          pmremGenerator.dispose();

          render();

          // model

          // use of RoughnessMipmapper is optional
          //var roughnessMipmapper = new RoughnessMipmapper( renderer );



        });
    }



    function onTransitionEnd(event) {

      event.target.remove();
      $("loading-screen").remove();

    }


    function loadModels() {

      const loader = new GLTFLoader(loadingManager);
      const onLoad = (gltf, position) => {

        const model = gltf.scene.children[0];

        model.position.copy(position);
        const animation = gltf.animations[0];
        const mixer = new THREE.AnimationMixer(model);
        // mixers.push(mixer);
        // const action = mixer.clipAction(animation);
        //  action.play();

        //model.castShadow = false;
        //model.receiveShadow = true;
        scene.add(model);

        const dentro = [];

        model.traverse(function (child) {

          if (child.name != "0") {
            child.castShadow = true;

          }


          child.receiveShadow = true;






          if (!child.isMesh) {
            if (child.name != "Null" && child.name)
              console.log("child.isMesh " + child.name);

            dentro.push(child);

          }

        });

        etiqueta();

        console.log(dentro.length);

        function etiqueta() {

          for (paso = 1; paso < dentro.length - 1; paso++) {
            var earthDiv;
            var earthLabel;
            var paso;

            var idNombre = paso;
            console.log("label " + paso + " " + dentro[paso].userData.name);



            //earthDiv.className = dentro[paso].userData.name;
            earthDiv = document.createElement('tag');
            //earthDiv.textContent = dentro[paso].userData.name;

            earthDiv.textContent = idNombre;
            earthDiv.style.marginTop = '-1em';
            earthLabel = new CSS2DObject(earthDiv);
            earthLabel.position.set(0, .6, 0);
            dentro[paso].add(earthLabel);
            $(earthDiv).attr('id', idNombre);

          };

        }


        function onTouchMove(event) {

          var x, y;

          if (event.changedTouches) {

            x = event.changedTouches[0].pageX;
            y = event.changedTouches[0].pageY;

          } else {

            x = event.clientX;
            y = event.clientY;

          }

          var rect = renderer.domElement.getBoundingClientRect();

          // mouse.x = (x / window.innerWidth) * 2 - 1;
          // mouse.y = - (y / window.innerHeight) * 2 + 1;

          mouse.x = ((event.clientX - rect.left) / (rect.width - rect.left)) * 2 - 1;
          mouse.y = -((event.clientY - rect.top) / (rect.bottom - rect.top)) * 2 + 1;



          // mouse.y = - (y / window.innerHeight-renderer.domElement.offsetTop) * 2 + 1;

          //mouse.x=((event.clientX-renderer.domElement.offsetLeft)/renderer.domElement.width)*2-1;

          //mouse.y=-((event.clientY-renderer.domElement.offsetTop)/renderer.domElement.width)*2+1;

          checkIntersection();

        }


        function addSelectedObject(object) {

          selectedObjects = [];
          selectedObjects.push(object);




          var idNombre = selectedObjects[0].parent.userData.name;

          if (idNombre != undefined) {

            idNombre = '#' + selectedObjects[0].parent.userData.name.charAt(0) + selectedObjects[0].parent.userData.name.charAt(5);

            $('#2c').addClass('invisible');

          }


          // $("#"+selectedObjects[0].parent.userData.name).addClass("visible");





        }


        function checkIntersection() {

          raycaster.setFromCamera(mouse, camera);

          var intersects = raycaster.intersectObjects([scene], true);

          if (intersects.length > 0) {


            var selectedObject = intersects[0].object;





            var str_pos = selectedObject.name.indexOf("0");





            if (selectedObject.name == 0) {




            } else {
              $('tag').remove();

              addSelectedObject(selectedObject);

              outlinePass.selectedObjects = selectedObjects;

              $('#txtInfo').text(selectedObject.parent.userData.name);

              // outlinePass.selectedObjects = [];

              //$("." + selectedObject.name).remove();




            }



          }

        }


        function clicked(event) {

          if (detector.mobile() != null) {
            console.log("ESTAS EN MOBILE");
            mouse.x = +(event.targetTouches[0].pageX / window.innerWidth) * 2 + -1;
            mouse.y = -(event.targetTouches[0].pageY / window.innerHeight) * 2 + 1;
          } else {
            console.log("ESTAS EN DESKTOP");



            //mouse.x = ((event.clientX - rect.left) / (rect.width - rect.left)) * 2 - 1;
            //mouse.y = -((event.clientY - rect.top) / (rect.bottom - rect.top)) * 2 + 1;








            raycaster.setFromCamera(mouse, camera);

            const arreglo = [];

            const intersects = raycaster.intersectObject(model, true);

            //console.log("intersects = "+ intersects);


            console.log("El nombre se llama: " + intersects[0].object.position.x);

            if (intersects[0].object.userData.name != 0) {

              const posClick = new THREE.Vector3();
              //const objeto = new THREE.object();

              //scene.updateMatrixWorld();
              //model.updateMatrixWorld();

              camPosX = intersects[0].object.position.x;
              camPosY = intersects[0].object.position.y;
              camPosZ = intersects[0].object.position.z;

              //(intersects[0].object).getWorldPosition(camVector.position);


              //scene.updateMatrixWorld();

              //camVector.setFromMatrixPosition ((intersects[0].object).matrixWorld.position);

              //camVector = intersects[0].object.matrixWorld;

              intersects[0].object.updateMatrixWorld();

              intersects[0].object.parent.children[0].getWorldPosition(camVector);



              console.log("camVector = " + camVector.x)

              //console.log(" CAMARA ESTA EN "+ camPosX + " "+camPosY+" "+camPosZ );

              //camera.position.set(camVector.x+.5, camVector.y, camVector.z+6); // Set position like this
              //camera.lookAt(new THREE.Vector3(camVector.x, camVector.y, camVector.z-6)); // Set look at coordinate like this
            }


            // posClick.setFromMatrixPosition(intersects[0].object.matrixWorld);}

            if (intersects[0].object.name != 0) {

              console.log("abreModalMObile " + intersects[0].object.name);

              abreModalMobile(intersects[0].object.name);

            }






          }

        }

        window.addEventListener('mousemove', onTouchMove);
        window.addEventListener('touchmove', onTouchMove);

        if (detector.mobile() != null) {
          console.log("ESTAS EN MOBILE");
          renderer.domElement.addEventListener('touchstart', function (event) {
            // find intersections
            clicked(event);
            camera.updateMatrixWorld();
          });
        } else {
          console.log("ESTAS EN DESKTOP");
          //document.getElementById('canvas1').appendChild(renderer.domElement);
          // $("canvas1").setSize(window.innerWidth, window.innerHeight / 2);
          renderer.domElement.addEventListener('mousedown', function (event) {
            // find intersections
            clicked(event);
            //camera.updateMatrixWorld();
          });
        }








      };


      const onProgress = () => { };


      const onError = (errorMessage) => {
        console.log(errorMessage);
      };


      const demoroomPosition = new THREE.Vector3(0, 0, 0);
      loader.load('three/models/demoRoom3.gltf', gltf => onLoad(gltf, demoroomPosition), onProgress, onError);



    }

    createHUD();

    function createHUD() {

      lightShadowMapViewer = new ShadowMapViewer(light);
      lightShadowMapViewer.position.x = 10;
      lightShadowMapViewer.position.y = SCREEN_HEIGHT - (SHADOW_MAP_HEIGHT / 4) - 10;
      lightShadowMapViewer.size.width = SHADOW_MAP_WIDTH / 4;
      lightShadowMapViewer.size.height = SHADOW_MAP_HEIGHT / 4;
      lightShadowMapViewer.update();

    }




    function render() {

      labelRenderer.render(scene, camera);

      renderer.toneMappingExposure = 0.65;



      //renderer.setViewport(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT / 2);



      renderer.render(scene, camera);
      composer.render();

      composer2.render();

      //composer3.render();

      //camera.updateProjectionMatrix();

      requestAnimationFrame(render);



    }

    window.requestAnimationFrame(render);


    window.addEventListener('resize', onWindowResize, false);

    function onWindowResize() {

      camera.aspect = aspect * 2;
      //camera.aspect =window.innerWidth*2/window.innerHeight;

      //renderer.setSize(window.innerWidth, window.innerHeight / 2);
      //$("canvas1").setSize(window.innerWidth, window.innerHeight / 2);
      //labelRenderer.setSize(window.innerWidth, window.innerHeight / 2);

      renderer.setViewport(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT / 2);
      //outlinePass.setViewport(0,0, SCREEN_WIDTH , SCREEN_HEIGHT/2);



      camera.updateProjectionMatrix();

      composer2.setSize(container.offsetWidth, container.offsetHeight);
      //composer3.setSize(container.offsetWidth, container.offsetHeight);

      var pixelRatio = renderer.getPixelRatio();

      fxaaPass.material.uniforms['resolution'].value.x = 1 / (container.offsetWidth * pixelRatio);
      fxaaPass.material.uniforms['resolution'].value.y = 1 / (container.offsetHeight * pixelRatio);




    }

    function onDocumentMouseMove(event) {

      event.preventDefault();

      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      //mouse.x =((event.clientX-rect.left)/(rect.right-rect.left))*2-1;
      mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;




    }



    function frameArea(sizeToFitOnScreen, boxSize, boxCenter, camera) {
      const halfSizeToFitOnScreen = sizeToFitOnScreen * 0.5;
      const halfFovY = THREE.MathUtils.degToRad(camera.fov * .5);
      const distance = halfSizeToFitOnScreen / Math.tan(halfFovY);
      // compute a unit vector that points in the direction the camera is now
      // in the xz plane from the center of the box
      const direction = (new THREE.Vector3())
        .subVectors(camera.position, boxCenter)
        .multiply(new THREE.Vector3(1, 0, 1))
        .normalize();

      // move the camera to a position distance units way from the center
      // in whatever direction the camera was from the center already
      camera.position.copy(direction.multiplyScalar(distance).add(boxCenter));

      // pick some near and far values for the frustum that
      // will contain the box.
      camera.near = boxSize / 100;
      camera.far = boxSize * 100;

      camera.updateProjectionMatrix();

      // point the camera to look at the center of the box
      camera.lookAt(boxCenter.x, boxCenter.y, boxCenter.z);
    }

    function onMouseMove(event) {

      // calculate mouse position in normalized device coordinates
      // (-1 to +1) for both components

      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.x = ((event.clientX - rect.left) / (rect.right - rect.left)) * 2 - 1;
      mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;

    }


    //inicialPlay();


    function inicialPlay() {

      $("#exampleModalCenter").modal();



      $('#exampleModalLongTitle').text("Mantenimiento");


      const myPlayer = videojs("my-video");
      myPlayer.play();


    }





  </script>


  <!--
  <div class="over-loader loader-live">
    <div class="loader">
      <div class="loader-item style4">
        <div class="cube1"></div>
        <div class="cube2"></div>
      </div>
    </div>
  </div>
  end loading-->





  <div class="clearfix"></div>



  <div id="inicio" class="vertical-align section-light">
    <div>
      <div class="container sec-tpadding-2 sec-bpadding-2">
        <div class="row">

          <div class="col-md-12 text-center">


            <div class="col-sm-12">
              <div class="sec-title-container less-padding-1 text-center">

                <h2 class="font-weight-6 less-mar-1 line-height-5 text-blue baloo">
                  <div class="texto-chico">Plantas</div>
                  <div class="texto-grande">potabilizadoras</div>
                </h2>
                <div class="ce-title-line"></div>
                <br />
                <h6 class="ce-sub-text raleway opacity-6 text-gray">

                  La Comisión Estatal del Agua de Guanajuato, comprometida en garantizar la calidad del agua
                  a lo largo del Estado, proporciona plantas potabilizadoras de agua. <br>
                  <br>
                  Conoce el funcionamiento y el proceso de mantenimiento de estas plantas.



                </h6>
              </div>
            </div>
            <div class="clearfix"></div>
            <!--end title-->


            <a class="redondo" href="#funcionamiento"> Funcionamiento</a>

            <a class="redondo" href="#mantenimiento"> Mantenimiento</a>


          </div>
          <!--end item-->


        </div>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>
  <!-- end section -->

  <div id="triangulo-blanco"></div>

  <div id="funcionamiento" class="vertical-align section-blue">

    <div>
      <div class="container sec-tpadding-2">
        <div class="row">

          <div class="col-md-12 text-center">


            <div class="col-sm-12">
              <div class="sec-title-container less-padding-1 text-center">



                <video id="my-video" class="video-js vjs-fluid " controls preload="auto" poster="three/img/thumb.png"
                  data-setup="{}">
                  <source src="three/video/0.mp4" type="video/mp4" />
                  <p class="vjs-no-js">
                    To view this video please enable JavaScript, and
                    consider upgrading to a
                    web browser that
                    <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
                  </p>
                </video>

                <h2 class="font-weight-6 less-mar-1 line-height-5 text-white baloo texto-grande espacio-arriba">
                  Funcionamiento</h2>

                <h6 class="ce-sub-text raleway opacity-6 text-white">

                  Video informativo sobre el funcionamiento de la planta potabilizadora.

                </h6>

              </div>


            </div>

            <div class="clearfix"></div>
            <!--end title-->





          </div>
          <!--end item-->


        </div>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>
  <!-- end section -->

  <div id="triangulo-azul"></div>



  <div id="mantenimiento" class="vertical-align section-light">
    <div>
      <div class="container sec-tpadding-2 padding-menor">
        <div class="row">

          <div class="col-md-12 text-center">


            <div class="col-sm-12">
              <div class="sec-title-container less-padding-6 text-center">

                <h2 class="font-weight-6 less-mar-1 line-height-5 text-blue baloo">
                  <div class="texto-chico">Instrucciones de </div>

                  <div class="texto-grande">mantenimiento</div>
                </h2>
                <div class="ce-title-line"></div>
                <br />
                <h6 class="ce-sub-text raleway opacity-6 text-gray">
                  Conoce más sobre la sección que deseas dar mantenimiento.
                </h6>

                <div id="js-filters-mosaic-flat" class="cbp-l-filters-buttonCenter round">


                  <div data-filter="*" class="cbp-filter-item textoazul">Rotar <br>
                    <img src="three/img/icons/rotar.png">

                  </div>

                  <div data-filter=".print" class="cbp-filter-item textoazul"> Zoom <br>
                    <img src="three/img/icons/zoom.png">

                  </div>

                  <div data-filter=".web-design" class="cbp-filter-item textoazul"> Elegir proceso<br>
                    <img src="three/img/icons/clic.png">


                  </div>


                </div>

              </div>
            </div>
            <div class="clearfix"></div>
            <!--end title-->



          </div>
          <!--end item-->


        </div>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>
  <!-- end section -->







  <div id="plantaMobile" class="vertical-alineacion">

    <img id="img_ID" src="three/img/planta-mobile-g2.png" class="rounded mx-auto d-block img-fluid centrado"
      usemap="#map" />
    <!--
    <map id="map_ID" name="map">
      <area id="map1" shape="rect" coords="1046,62,1096,175" />
      <area id="map2" shape="rect" coords="841,91,1036,306" />
      <area id="map3" shape="rect" coords="773,143,805,257" />
      <area id="map4" shape="rect" coords="733,143,766,257" />
      <area id="map5" shape="rect" coords="701,143,734,257" />
      <area id="map6" shape="rect" coords="650,175,694,257" />
      <area id="map7" shape="rect" coords="605,166,641,257" />
      <area id="map8" shape="rect" coords="325,86,490,294" />
      <area id="map9" shape="rect" coords="503,143,554,193" />
      <area id="map10" shape="rect" coords="550,136,602,196" />
      <area id="map11" shape="rect" coords="250,196,314,347" />
      <area id="map12" shape="rect" coords="125,215,233,435" />
    </map>
  -->

  </div>










  <div id="labels">

  </div>







  <!-- Modal -->
  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Modal
            title</h5>
          <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>-->
        </div>
        <div class="modal-body">





        </div>
        <div class="modal-footer">

        </div>
      </div>
    </div>
  </div>


  <!-- Modal MOBILE -->
  <div class="modal fade" id="modalMobile" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">

          <div class="row">

            <h5 class="modal-title col-xs-10" id="modalMobileTitle"></h5>

            <button type="button" class="close col-xs-2" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>

          </div>
        </div>
        <div class="modal-body">




          <div class="row">

            <div class="col-xs-12">

              <video id="my-video2" class="video-js vjs-fluid " controls preload="auto" poster="" data-setup="{}">
                <source src="three/video/0.mp4" type="video/mp4" />
                <p class="vjs-no-js">
                  To view this video please enable JavaScript,
                  and consider upgrading to a
                  web browser that
                  <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5
                    video</a>
                </p>
              </video>

            </div>
<!--
            <div class="col-xs-4">
              <img id="imgZoom" src="">
            </div>
-->

          </div>




        </div>
        <div class="modal-footer">

        </div>
      </div>
    </div>
  </div>

  <section id="loading-screen">

    <div id="loader"></div>

  </section>


  <div id="canvas1"></div>



  <div id="pasos" class="vertical-align section-light">
    <div class="mx-auto align-middle">

      <div class="text-center">
        <div id="txtInfo" class="mx-auto btn btn-secondary"></div>
      </div>



    </div>
    <div>
      <div class="container masjuntos sec-tpadding-x sec-bpadding-2">
        <div class="row">





          <div id="map1a" class="col-md-4 col-xs-6  espacio">

            <div class="iconbox-tiny center round bg-blue">1<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Cloración<br>

              </h4>
            </div>
          </div>
          <!--end item -->

          <div id="map2a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">2<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Recipiente de <br>
                agua cruda<br></h4>
            </div>
          </div>
          <!--end item -->





          <div id="map3a" class="col-md-4 col-xs-6 espacio">
            <div class="iconbox-tiny center round bg-blue">3<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Turbidex<br><br>
              </h4>

            </div>
          </div>
          <!--end item -->

          <div id="map4a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">4<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Carbón <br>
                activado<br></h4>

            </div>
          </div>
          <!--end item -->






          <div id="map5a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">5<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Suavizador <br> <br>
              </h4>

            </div>
          </div>
          <!--end item -->

          <div id="map6a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">6<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Muestreo<br><br>
              </h4>

            </div>
          </div>
          <!--end item -->





          <div id="map7a" class="col-md-4 col-xs-6   espacio">
            <div class="iconbox-tiny center round bg-blue">7<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Ósmosis<br>
                inversa<br></h4>
            </div>
          </div>
          <!--end item -->

          <div id="map8a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">8<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Cisterna de agua <br>
                potabilizadora<br></h4>
            </div>
          </div>
          <!--end item -->






          <div id="map9a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">9<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Lámpara de luz <br>
                ultravioleta<br></h4>

            </div>
          </div>
          <!--end item -->

          <div id="map10a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">10<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Generadora<br>
                de ozono<br></h4>

            </div>
          </div>
          <!--end item -->





          <div id="map11a" class="col-md-4 col-xs-6 espacio">
            <div class="iconbox-tiny center round bg-blue">11<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Lavado de garrafones<br><br></h4>

            </div>
          </div>
          <!--end item -->

          <div id="map12a" class="col-md-4 col-xs-6  espacio">
            <div class="iconbox-tiny center round bg-blue">12<span></span></div>

            <div class="text-box text-center">
              <h4 class="less-mar-1 ajuste">Llenado de garrafones<br><br></h4>

            </div>
          </div>
          <!--end item -->

        </div>
        <div class="clearfix"></div>
        <!--end title-->







      </div>
    </div>
  </div>
  </div>
  <div class="clearfix"></div>
  <!-- end section -->






  <section class="sec-padding-6 section-medium-dark">
    <div class="container">
      <div class="row">
        <div class="fo-copyright-holder text-center">

          <a href="http://guanajuato.gob.mx/igualdad-laboral.php"><img class="padding-menor"
              src="three/img/logo-gl-01.svg"></a><br>
          <div class="proxima-nova">
            Autopista Guanajuato-Silao Km 1, <br>
            Guanajuato, Gto. C.P 36521<br>
            01 (473) 735 1800 con 12 líneas<br>
          </div>


          <div id="js-filters-mosaic-flat" class="cbp-l-filters-buttonCenter padding-top">


            <div class="cbp-filter-item"><a href="https://www.twitter.com/Agua_Gto"><img
                  src="three/img/twitter.png"></a>

            </div>

            <div class="cbp-filter-item"><a href="https://www.facebook.com/AguaGto"><img
                  src="three/img/facebook.png"></a>

            </div>

            <div class="cbp-filter-item"><a href="https://www.youtube.com/user/CEAGuanajuato"><img
                  src="three/img/youtube.png"></a>


            </div>


          </div>

          <a class="liga" href="http://agua.guanajuato.gob.mx/pdf/aviso_privacidad/Aviso_de_Privacidad_CEAG.pdf">Aviso
            de privacidad</a>

          ©2020 Gobierno del Estado de Guanajuato. Derechos Reservados<br>

         






        </div>
      </div>
    </div>
  </section>
  <div class="clearfix"></div>
  <!-- end section -->

  <a href="#" class="scrollup"><i class="fa fa-angle-up" aria-hidden="true"></i></a>
  <!-- end scroll to top of the page-->

  </div>
  <!--end site wrapper-->
  </div>
  <!--end wrapper boxed-->

  <!-- Scripts -->
  <script src="html/js/jquery/jquery.js"></script>
  <script src="html/js/bootstrap/bootstrap.min.js"></script>
  <script src="html/js/style-customizer/js/spectrum.js"></script>
  <script src="html/js/less/less.min.js" data-env="development"></script>
  <script src="html/js/style-customizer/js/style-customizer.js"></script>
  <!-- Scripts END -->

  <!-- Template scripts -->
  <script src="html/js/megamenu/js/main.js"></script>
  <script type="text/javascript" src="html/js/ytplayer/jquery.mb.YTPlayer.js"></script>
  <script type="text/javascript" src="html/js/ytplayer/elementvideo-custom.js"></script>
  <script type="text/javascript" src="html/js/ytplayer/play-pause-btn.js"></script>

  <script src="html/js/parallax/parallax-background.min.js"></script>
  <script>
    (function ($) {
      $('.parallax').parallaxBackground();
    })(jQuery);
  </script>
  <script src="html/js/tabs/js/responsive-tabs.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="html/js/cubeportfolio/jquery.cubeportfolio.min.js"></script>
  <script type="text/javascript" src="html/js/cubeportfolio/main-mosaic3-cols3.js"></script>
  <script src="html/js/owl-carousel/owl.carousel.js"></script>
  <script src="html/js/owl-carousel/custom.js"></script>
  <script src="html/js/owl-carousel/owl.carousel.js"></script>
  <script src="html/js/accordion/js/smk-accordion.js"></script>
  <script src="html/js/accordion/js/custom.js"></script>
  <script src="html/js/progress-circle/raphael-min.js"></script>
  <script src="html/js/progress-circle/custom.js"></script>
  <script src="html/js/progress-circle/jQuery.circleProgressBar.js"></script>
  <script src="html/js/functions/functions.js"></script>
</body>

</html>